// ============================================================
//  Fetch API
//  서버에 HTTP 요청을 보내고 응답을 받는 Web API (브라우저 제공)
//
//  클라이언트(브라우저) → 서버 : 요청 (Request)
//  서버 → 클라이언트(브라우저) : 응답 (Response) ← 언제 올지 알 수 없음
// ============================================================


// -------------------------------------------------------
// 비동기 프로그래밍 (Asynchronous Programming)
//
//   fetch는 비동기적으로 처리 됨
//   요청을 보낸 후 응답을 기다리는 동안, 다른 코드를 계속 실행 함
//   응답이 오면 .then() 안의 함수가 실행 됨
//
//   흐름:
//   fetch 요청 보냄 → 기다리는 동안 다른 코드 실행 → 응답 오면 .then 실행
//
//   .then("오고 나면 이렇게 처리해라")
// -------------------------------------------------------


// -------------------------------------------------------
// 1. GET 요청 — 서버에서 데이터 가져오기
//    fetch(URL) 만 쓰면 기본적으로 GET 요청이 됨
// -------------------------------------------------------

fetch("https://jsonplaceholder.typicode.com/posts")
    // 서버에서 응답이 오면 첫 번째 .then 실행
    // response : 서버가 보낸 응답 객체 (아직 데이터가 아님)
    // response.json() : 응답 본문을 JSON 형식으로 파싱 (변환)
    .then((response) => response.json())

    // 첫 번째 .then이 끝나면 두 번째 .then 실행
    // data : 파싱된 실제 데이터 (배열 또는 객체)
    .then((data) => console.log(data));


// -------------------------------------------------------
// 2. POST 요청 — 서버로 데이터 보내기
//    fetch(URL, 옵션객체) 형태로 작성
//
//    옵션 설명:
//      method  : 요청 방식 (GET이 기본값 / POST, PUT, DELETE 등)
//      headers : 요청에 대한 부가 정보 (어떤 형식의 데이터를 보내는지)
//      body    : 실제로 서버에 보낼 데이터
//                ⚠️ 문자열만 전달 가능하므로 JSON.stringify()로 변환 필수
// -------------------------------------------------------

fetch("https://jsonplaceholder.typicode.com/posts", {
    method: "POST",                                          // POST 요청 방식 지정
    headers: { "Content-Type": "application/json" },        // JSON 형식으로 보낸다고 서버에 알림
    body: JSON.stringify({ title: "myTitle", body: "Body" }) // 객체를 JSON 문자열로 변환해서 전송
})
    // 서버에서 응답이 오면 실행
    .then((response) => response.json())  // 응답을 JSON으로 파싱

    // 파싱된 데이터 출력
    .then((data) => console.log(data));


// -------------------------------------------------------
// 3. GET vs POST 비교
//
//   GET  : 데이터를 가져올 때    / body 없음
//   POST : 데이터를 서버로 보낼 때 / body 있음 (보낼 데이터)
//
// -------------------------------------------------------


// -------------------------------------------------------
// 4. .then() 체이닝 흐름 정리
//
//   1단계 : fetch(URL) → 서버에 요청을 보냄
//   2단계 : 응답이 오면 첫 번째 .then 실행 → response.json()으로 파싱
//   3단계 : 파싱이 끝나면 두 번째 .then 실행 → data 사용
//
//   .then을 여러 개 이어붙이는 방식을 "Promise 체이닝"이라고 함
// -------------------------------------------------------